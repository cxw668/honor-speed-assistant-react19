import{a as e,i as t,o as n,t as r}from"./index-BuJs-lT0.js";import{n as i,t as a}from"./hero-_O4KuQx5.js";import{t as o}from"./Button-B-yg1s7X.js";var s=t(),c=n(),l=r();const u=e=>{let t=(0,s.c)(30),{value:n,onChange:r}=e,[a,o]=(0,c.useState)(!1),[u,h]=(0,c.useState)(``),g=(0,c.useRef)(null),_;if(t[0]===Symbol.for(`react.memo_cache_sentinel`)){let e=Object.values(i).flatMap(d);_=Array.from(new Map(e.map(f)).values()).map(p),t[0]=_}else _=t[0];let v=_,y;t[1]===n?y=t[2]:(y=v.find(e=>e.id===Number(n)),t[1]=n,t[2]=y);let b=y,x;bb0:{if(!u){x=v;break bb0}let e;t[3]===u?e=t[4]:(e=v.filter(e=>e.heroName.toLowerCase().includes(u.toLowerCase())),t[3]=u,t[4]=e),x=e}let S=x,C,w;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(C=()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&o(!1)};return document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},w=[],t[5]=C,t[6]=w):(C=t[5],w=t[6]),(0,c.useEffect)(C,w);let T;t[7]===r?T=t[8]:(T=e=>{r(e),o(!1),h(``)},t[7]=r,t[8]=T);let E=T,D=`
          flex items-center gap-3 bg-bg-card border-2 rounded-2xl px-4 py-3 cursor-pointer transition-all
          ${a?`border-primary shadow-lg shadow-primary/10`:`border-border-light hover:border-primary/50`}
        `,O;t[9]===a?O=t[10]:(O=()=>o(!a),t[9]=a,t[10]=O);let k;t[11]===b?k=t[12]:(k=b?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(`img`,{src:b.avatar,alt:b.heroName,className:`w-8 h-8 rounded-lg shadow-sm`}),(0,l.jsx)(`span`,{className:`text-text-primary font-bold text-lg flex-1`,children:b.heroName})]}):(0,l.jsx)(`span`,{className:`font-bold text-lg flex-1`,children:`请选择英雄`}),t[11]=b,t[12]=k);let A=`text-text-secondary transition-transform duration-200 ${a?`rotate-180`:``}`,j;t[13]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,l.jsx)(`path`,{d:`m6 9 6 6 6-6`}),t[13]=j):j=t[13];let M;t[14]===A?M=t[15]:(M=(0,l.jsx)(`svg`,{className:A,xmlns:`http://www.w3.org/2000/svg`,width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`3`,strokeLinecap:`round`,strokeLinejoin:`round`,children:j}),t[14]=A,t[15]=M);let N;t[16]!==M||t[17]!==D||t[18]!==O||t[19]!==k?(N=(0,l.jsxs)(`div`,{className:D,onClick:O,children:[k,M]}),t[16]=M,t[17]=D,t[18]=O,t[19]=k,t[20]=N):N=t[20];let P;t[21]!==S||t[22]!==E||t[23]!==a||t[24]!==u||t[25]!==n?(P=a&&(0,l.jsxs)(`div`,{className:`absolute top-full left-0 right-0 mt-2 bg-bg-card border-2 border-border-light rounded-2xl shadow-2xl z-[100] overflow-hidden animate-in fade-in zoom-in-95 duration-200`,children:[(0,l.jsx)(`div`,{className:`p-3 border-b border-border-light bg-bg-page/50`,children:(0,l.jsxs)(`div`,{className:`relative`,children:[(0,l.jsx)(`input`,{autoFocus:!0,type:`text`,placeholder:`搜索英雄名称...`,className:`w-full bg-bg-page border border-border-light rounded-xl px-9 py-2 text-sm focus:outline-none focus:border-primary/50 text-text-primary`,value:u,onChange:e=>h(e.target.value),onClick:m}),(0,l.jsxs)(`svg`,{className:`absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary`,xmlns:`http://www.w3.org/2000/svg`,width:`16`,height:`16`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,l.jsx)(`circle`,{cx:`11`,cy:`11`,r:`8`}),(0,l.jsx)(`path`,{d:`m21 21-4.3-4.3`})]})]})}),(0,l.jsx)(`div`,{className:`max-h-[300px] overflow-y-auto scrollbar-hide`,children:S.length>0?S.map(e=>(0,l.jsxs)(`div`,{className:`
                    flex items-center gap-3 px-4 py-3 cursor-pointer transition-colors
                    ${Number(n)===e.id?`bg-primary/10 text-primary`:`hover:bg-bg-page text-text-primary`}
                  `,onClick:()=>E(e.id),children:[(0,l.jsx)(`img`,{src:e.avatar,alt:e.heroName,className:`w-10 h-10 rounded-xl shadow-sm`}),(0,l.jsxs)(`div`,{className:`flex flex-col`,children:[(0,l.jsx)(`span`,{className:`font-bold`,children:e.heroName}),(0,l.jsx)(`span`,{className:`text-[10px] opacity-60`,children:e.heroType})]}),Number(n)===e.id&&(0,l.jsx)(`svg`,{className:`ml-auto`,xmlns:`http://www.w3.org/2000/svg`,width:`18`,height:`18`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`3`,strokeLinecap:`round`,strokeLinejoin:`round`,children:(0,l.jsx)(`path`,{d:`M20 6 9 17l-5-5`})})]},e.id)):(0,l.jsx)(`div`,{className:`py-8 text-center text-text-secondary`,children:(0,l.jsx)(`p`,{className:`text-sm`,children:`未找到相关英雄`})})})]}),t[21]=S,t[22]=E,t[23]=a,t[24]=u,t[25]=n,t[26]=P):P=t[26];let F;return t[27]!==N||t[28]!==P?(F=(0,l.jsxs)(`div`,{className:`relative w-full`,ref:g,children:[N,P]}),t[27]=N,t[28]=P,t[29]=F):F=t[29],F};function d(e){return e}function f(e){return[e.id,e]}function p(e){let t=a.find(t=>t.hero===e.heroName)?.hero_src;return{...e,avatar:t}}function m(e){return e.stopPropagation()}var h=t();const g=e=>{let t=(0,h.c)(5),{activeScene:n,onSceneChange:r}=e,i;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i=[`常规`,`顺风`,`逆风`],t[0]=i):i=t[0];let a=i,s;t[1]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,l.jsx)(`label`,{className:`text-desc text-sm font-bold ml-1`,children:`对局场景`}),t[1]=s):s=t[1];let c;return t[2]!==n||t[3]!==r?(c=(0,l.jsxs)(`div`,{className:`flex gap-2`,children:[s,(0,l.jsx)(`div`,{className:`flex gap-3 bg-bg-card p-1.5 rounded-2xl border-2 border-border-light`,children:a.map(e=>(0,l.jsx)(o,{variant:n===e?`primary`:`secondary`,onClick:()=>r(e),className:`flex-1 !rounded-xl !py-2 shadow-none`,size:`sm`,children:e},e))})]}),t[2]=n,t[3]=r,t[4]=c):c=t[4],c};var _=t(),v=e();const y=e=>{let t=(0,_.c)(14),{message:n,duration:r,onClose:i,type:a}=e,o=r===void 0?2e3:r,s=a===void 0?`info`:a,[u,d]=(0,c.useState)(!0),f,p;t[0]!==o||t[1]!==i?(f=()=>{let e=setTimeout(()=>{d(!1),setTimeout(i,300)},o);return()=>clearTimeout(e)},p=[o,i],t[0]=o,t[1]=i,t[2]=f,t[3]=p):(f=t[2],p=t[3]),(0,c.useEffect)(f,p);let m;t[4]===Symbol.for(`react.memo_cache_sentinel`)?(m={success:`bg-success`,error:`bg-danger`,info:`bg-primary`},t[4]=m):m=t[4];let h=m,g=`
      fixed top-10 left-1/2 -translate-x-1/2 z-[100]
      ${u?`animate-in fade-in slide-in-from-top-4`:`animate-out fade-out slide-out-to-top-4`}
      duration-300
    `,y=`${h[s]} text-white px-6 py-3 rounded-full shadow-2xl font-bold flex items-center gap-3`,b;t[5]===s?b=t[6]:(b=s===`success`&&(0,l.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`3`,strokeLinecap:`round`,strokeLinejoin:`round`,children:(0,l.jsx)(`path`,{d:`M20 6 9 17l-5-5`})}),t[5]=s,t[6]=b);let x;t[7]!==n||t[8]!==y||t[9]!==b?(x=(0,l.jsxs)(`div`,{className:y,children:[b,n]}),t[7]=n,t[8]=y,t[9]=b,t[10]=x):x=t[10];let S;return t[11]!==g||t[12]!==x?(S=(0,v.createPortal)((0,l.jsx)(`div`,{className:g,children:x}),document.body),t[11]=g,t[12]=x,t[13]=S):S=t[13],S},b=({text:e,label:t=`一键复制出装`})=>{let[n,r]=(0,c.useState)(!1),[i,a]=(0,c.useState)(``),[s,u]=(0,c.useState)(`success`),[d,f]=(0,c.useState)(!1);return(0,l.jsxs)(`div`,{className:`w-full flex flex-col gap-3`,children:[(0,l.jsxs)(o,{fullWidth:!0,onClick:async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e),a(`出装方案已复制`),u(`success`),r(!0);else throw Error(`Clipboard API not available`)}catch(e){console.error(`Failed to copy: `,e),f(!0),a(`复制失败，请手动复制`),u(`error`),r(!0)}},children:[(0,l.jsxs)(`svg`,{className:`mr-2`,xmlns:`http://www.w3.org/2000/svg`,width:`20`,height:`20`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,strokeWidth:`2.5`,strokeLinecap:`round`,strokeLinejoin:`round`,children:[(0,l.jsx)(`rect`,{width:`14`,height:`14`,x:`8`,y:`8`,rx:`2`,ry:`2`}),(0,l.jsx)(`path`,{d:`M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2`})]}),t]}),d&&(0,l.jsxs)(`div`,{className:`animate-in fade-in slide-in-from-top-2 duration-300`,children:[(0,l.jsx)(`textarea`,{readOnly:!0,value:e,className:`w-full h-24 p-3 bg-bg-page border-2 border-dashed border-border-light rounded-xl text-sm text-text-secondary focus:outline-none`,onClick:e=>e.target.select()}),(0,l.jsx)(`p`,{className:`text-[12px] text-text-secondary mt-1 text-center`,children:`由于系统限制，请长按上方文本框手动全选复制`})]}),n&&(0,l.jsx)(y,{message:i,type:s,onClose:()=>r(!1)})]})};export{u as i,y as n,g as r,b as t};